<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1jour1histoire - Chaque jour une surprise !</title>
    
    <!-- Performance optimizations -->
    <meta http-equiv="Cache-Control" content="max-age=3600">
    <meta name="theme-color" content="#4a90e2">
    <link rel="preconnect" href="https://images.unsplash.com">
    <link rel="dns-prefetch" href="https://www.w3schools.com">
    <link rel="dns-prefetch" href="https://sample-videos.com">
    
    <!-- Preload critical fonts -->
    <link rel="preload" href="data:font/woff2;base64," as="font" type="font/woff2" crossorigin>
    <style>
        /* Performance optimizations */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Force hardware acceleration for better performance */
        .video-background,
        .welcome-message,
        .chapter-button,
        .quiz-answer,
        .memo-timer {
            transform: translateZ(0);
            will-change: transform;
        }

        /* Optimize repaints */
        .category-menu,
        .kofi-button-bottom,
        .tiktok-button-bottom {
            contain: layout style paint;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            color: white;
            position: relative;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            object-fit: cover;
        }

        .video-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        .video-info {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 15px;
            border-radius: 25px;
            font-size: 0.9rem;
            color: #4a90e2;
            border: 1px solid #4a90e2;
            z-index: 10;
            backdrop-filter: blur(10px);
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 15px;
            position: relative;
            z-index: 1;
        }

        /* Bloc principal du titre - DESIGN ENFANT PARFAIT */
        .hero-welcome {
            /* Positionnement et espacement */
            margin: 160px auto 40px auto; /* Espace de la barre fixe + marges */
            max-width: 90%;
            width: fit-content;
            min-width: 320px;
            
            /* CORRECTION Z-INDEX - Priorit√© maximale */
            position: relative;
            z-index: 150; /* Plus √©lev√© que le menu (100) */
            
            /* Centrage parfait */
            text-align: center;
            display: block;
            
            /* Style visuel enfant */
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.95) 0%, 
                rgba(240, 248, 255, 0.9) 100%);
            
            /* Bordures et formes */
            border-radius: 25px;
            border: 3px solid #6ba3e8;
            
            /* Ombres douces */
            box-shadow: 
                0 8px 32px rgba(107, 163, 232, 0.3),
                0 4px 16px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            
            /* Espacement interne g√©n√©reux */
            padding: 30px 25px;
            
            /* Transitions fluides */
            transition: all 0.3s ease;
            
            /* Effet de profondeur */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            
            /* Animation d'entr√©e */
            animation: heroFadeIn 0.8s ease-out;
        }

        /* Titre principal */
        .hero-title {
            /* Taille responsive et lisible */
            font-size: clamp(1.8rem, 5.5vw, 3rem);
            
            /* Police adapt√©e aux enfants */
            font-family: 'Comic Sans MS', 'Segoe UI', sans-serif;
            font-weight: 700;
            
            /* Couleur vive et joyeuse */
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            
            /* Animation arc-en-ciel */
            animation: rainbowText 4s ease-in-out infinite;
            
            /* Espacement */
            margin: 0 0 15px 0;
            line-height: 1.2;
            
            /* Effet de texte */
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            letter-spacing: 1px;
        }

        /* Sous-titre */
        .hero-subtitle {
            /* Taille et lisibilit√© */
            font-size: clamp(1.1rem, 3vw, 1.5rem);
            
            /* Police claire */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-weight: 600;
            
            /* Couleur douce */
            color: #2c3e50;
            
            /* Espacement */
            margin: 0;
            line-height: 1.4;
            
            /* Style d√©coratif */
            position: relative;
            
            /* Ombre l√©g√®re */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }

        /* D√©coration sous le sous-titre */
        .hero-subtitle::after {
            content: "‚ú®";
            display: inline-block;
            margin-left: 8px;
            animation: sparkle 2s ease-in-out infinite;
        }

        /* Animation arc-en-ciel pour le titre */
        @keyframes rainbowText {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Animation d'entr√©e du bloc */
        @keyframes heroFadeIn {
            0% { 
                opacity: 0; 
                transform: translateY(-30px) scale(0.95); 
            }
            100% { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }

        /* Animation des √©toiles */
        @keyframes sparkle {
            0%, 100% { 
                transform: scale(1) rotate(0deg); 
                opacity: 1; 
            }
            50% { 
                transform: scale(1.2) rotate(180deg); 
                opacity: 0.8; 
            }
        }

        /* Effet au survol (pour les √©crans tactiles) */
        .hero-welcome:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 12px 40px rgba(107, 163, 232, 0.4),
                0 6px 20px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
        }

        /* üîù BARRE DE NAVIGATION FIXE EN HAUT */
        .top-bar {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: rgba(30, 30, 30, 0.95);
            color: white;
            padding: 10px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(74, 144, 226, 0.3);
        }

        .top-bar h1 {
            margin: 0;
            font-size: 1.5rem;
            font-family: 'Comic Sans MS', 'Segoe UI', sans-serif;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: rainbowText 4s ease-in-out infinite;
        }

        .nav-categories {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 10px;
            gap: 15px;
        }

        .nav-categories a {
            color: white;
            text-decoration: none;
            background: rgba(74, 144, 226, 0.8);
            padding: 10px 15px;
            border-radius: 25px;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.9rem;
            border: 2px solid transparent;
        }

        .nav-categories a:hover {
            background: rgba(74, 144, 226, 1);
            transform: translateY(-2px) scale(1.05);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.4);
        }

        .nav-categories a:active {
            transform: translateY(0) scale(1.02);
        }

        /* RESPONSIVE POUR LA BARRE DE NAVIGATION */
        @media (max-width: 768px) {
            .top-bar {
                padding: 8px 15px;
            }
            
            .top-bar h1 {
                font-size: 1.3rem;
            }
            
            .nav-categories {
                gap: 10px;
                margin-top: 8px;
            }
            
            .nav-categories a {
                padding: 8px 12px;
                font-size: 0.8rem;
                border-radius: 20px;
            }
            
            .hero-welcome {
                margin: 140px auto 30px auto; /* Ajust√© pour la barre r√©duite */
            }
        }

        @media (max-width: 480px) {
            .top-bar {
                padding: 6px 10px;
            }
            
            .top-bar h1 {
                font-size: 1.1rem;
            }
            
            .nav-categories {
                gap: 8px;
                margin-top: 6px;
            }
            
            .nav-categories a {
                padding: 6px 10px;
                font-size: 0.75rem;
                border-radius: 18px;
                font-weight: 500;
            }
            
            .hero-welcome {
                margin: 120px auto 25px auto; /* Ajust√© pour mobile */
            }
        }

        @media (max-width: 320px) {
            .top-bar {
                padding: 5px 8px;
            }
            
            .top-bar h1 {
                font-size: 1rem;
            }
            
            .nav-categories {
                gap: 6px;
                margin-top: 5px;
            }
            
            .nav-categories a {
                padding: 5px 8px;
                font-size: 0.7rem;
                border-radius: 15px;
                font-weight: 500;
            }
            
            .hero-welcome {
                margin: 100px auto 20px auto; /* Ajust√© pour tr√®s petit mobile */
            }
        }

        /* Animation compatible tous navigateurs */
        @keyframes menuFloatCompat {
            0%, 100% { transform: translateX(50%) translateY(0px); }
            50% { transform: translateX(50%) translateY(-2px); }
        }

        /* Effet hover simplifi√© mais efficace */
        .category-menu:hover {
            transform: translateX(50%) translateY(-3px);
            box-shadow: 
                0 8px 30px rgba(107, 163, 232, 0.5),
                0 4px 15px rgba(0, 0, 0, 0.15);
        }

        /* Container pour le select avec fl√®che custom */
        .category-menu::after {
            content: '‚ñº';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6ba3e8;
            font-size: 14px;
            pointer-events: none;
            transition: transform 0.3s ease;
        }

        .category-menu:hover::after {
            transform: translateY(-50%) scale(1.1);
        }

        .category-menu select {
            /* Style enfant friendly */
            padding: 12px 35px 12px 18px;
            font-size: 15px;
            font-family: 'Comic Sans MS', 'Segoe UI', 'Arial', sans-serif;
            font-weight: 600;
            
            /* Couleurs cartoon */
            background: transparent;
            color: #2c3e50;
            
            /* Bordures et forme */
            border: none;
            border-radius: 15px;
            cursor: pointer;
            
            /* Taille responsive */
            min-width: 200px;
            width: 100%;
            
            /* Transitions compatibles */
            transition: all 0.3s ease;
            
            /* Masquer la fl√®che native de fa√ßon compatible */
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            
            /* Fallback pour IE */
            background-image: none;
        }

        /* Fallback pour IE - fl√®che visible */
        @media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {
            .category-menu::after {
                display: none;
            }
            
            .category-menu select {
                padding-right: 18px;
            }
        }

        /* Focus states accessibles */
        .category-menu select:focus {
            outline: 2px solid #6ba3e8;
            outline-offset: 2px;
            background: rgba(107, 163, 232, 0.1);
        }

        .category-menu select:hover {
            background: rgba(107, 163, 232, 0.05);
        }

        /* Options - styling minimal mais compatible */
        .category-menu select option {
            background: #ffffff;
            color: #2c3e50;
            padding: 8px 12px;
            font-weight: 600;
        }

        /* √âtats s√©lectionn√©s - compatible */
        .category-menu select option:checked,
        .category-menu select option[selected] {
            background: #6ba3e8;
            color: white;
        }

        /* Support moderne am√©lior√© pour navigateurs r√©cents */
        @supports (backdrop-filter: blur(10px)) {
            .category-menu {
                backdrop-filter: blur(15px);
                -webkit-backdrop-filter: blur(15px);
            }
        }

        /* Support des custom properties modernes */
        @supports (--css: variables) {
            .category-menu {
                --menu-primary: #6ba3e8;
                --menu-bg: rgba(255, 255, 255, 0.95);
                --menu-shadow: rgba(107, 163, 232, 0.4);
                
                border-color: var(--menu-primary);
                background: var(--menu-bg);
                box-shadow: 0 6px 25px var(--menu-shadow);
            }
        }

        .chapters-container {
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #4a90e2;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            display: none;
        }

        .chapters-container.show {
            opacity: 1;
            transform: translateY(0);
            display: block;
        }

        .chapters-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #4a90e2;
            text-align: center;
            font-weight: 600;
        }

        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .chapter-button {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }

        .chapter-button:hover {
            background: linear-gradient(135deg, #357abd, #2c5f99);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
        }

        .chapter-button:active {
            transform: translateY(0);
        }

        .story-display {
            background: rgba(20, 20, 20, 0.95);
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #4a90e2;
            margin-top: 20px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s ease;
            display: none;
            line-height: 1.6;
        }

        .story-display.show {
            opacity: 1;
            transform: translateY(0);
            display: block;
        }

        .quiz-container {
            background: rgba(20, 20, 20, 0.95);
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #4a90e2;
            margin-top: 20px;
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .quiz-score {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            display: inline-block;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .quiz-question {
            background: rgba(74, 144, 226, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #4a90e2;
            margin-bottom: 20px;
        }

        .quiz-question h3 {
            color: #4a90e2;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .quiz-answers {
            display: grid;
            gap: 10px;
        }

        .quiz-answer {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #4a90e2;
            color: white;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .quiz-answer:hover {
            background: rgba(74, 144, 226, 0.2);
            transform: translateX(5px);
        }

        .quiz-answer.correct {
            background: linear-gradient(135deg, #28a745, #20c997);
            border-color: #28a745;
            animation: correctAnswer 0.5s ease;
        }

        .quiz-answer.wrong {
            background: linear-gradient(135deg, #dc3545, #e74c3c);
            border-color: #dc3545;
            animation: wrongAnswer 0.5s ease;
        }

        .quiz-answer.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        @keyframes correctAnswer {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes wrongAnswer {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }

        .quiz-next {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin: 20px auto;
            display: none;
            transition: all 0.3s ease;
        }

        .quiz-next:hover {
            background: linear-gradient(135deg, #357abd, #2c5f99);
            transform: translateY(-2px);
        }

        .quiz-next.show {
            display: block;
        }

        .quiz-results {
            text-align: center;
            padding: 30px;
            background: rgba(74, 144, 226, 0.1);
            border-radius: 10px;
            border: 2px solid #4a90e2;
        }

        .quiz-results h2 {
            color: #4a90e2;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .quiz-results .final-score {
            font-size: 2rem;
            font-weight: bold;
            margin: 20px 0;
        }

        .quiz-results .score-excellent {
            color: #28a745;
        }

        .quiz-results .score-good {
            color: #ffc107;
        }

        .quiz-results .score-needs-improvement {
            color: #dc3545;
        }

        .quiz-restart {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .quiz-restart:hover {
            background: linear-gradient(135deg, #20c997, #17a085);
            transform: translateY(-2px);
        }

        .memo-container {
            background: rgba(20, 20, 20, 0.95);
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #4a90e2;
            margin-top: 20px;
        }

        .memo-phase {
            text-align: center;
        }

        .memo-story {
            background: rgba(74, 144, 226, 0.1);
            padding: 25px;
            border-radius: 10px;
            border: 1px solid #4a90e2;
            margin: 20px 0;
            line-height: 1.6;
            font-size: 1.1rem;
        }

        .memo-timer {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 15px 25px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
            font-size: 1.3rem;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
            animation: timerPulse 1s infinite;
        }

        @keyframes timerPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .memo-timer.warning {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            animation: timerWarning 0.5s infinite;
        }

        .memo-timer.danger {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            animation: timerDanger 0.3s infinite;
        }

        @keyframes timerWarning {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes timerDanger {
            0% { transform: scale(1); box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4); }
            50% { transform: scale(1.15); box-shadow: 0 6px 25px rgba(244, 67, 54, 0.8); }
            100% { transform: scale(1); box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4); }
        }

        .memo-question {
            background: rgba(74, 144, 226, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #4a90e2;
            margin: 20px 0;
        }

        .memo-question h3 {
            color: #4a90e2;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .memo-input {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #4a90e2;
            border-radius: 8px;
            color: white;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .memo-input:focus {
            outline: none;
            border-color: #6bb6ff;
            box-shadow: 0 0 10px rgba(107, 182, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
        }

        .memo-submit {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .memo-submit:hover:not(:disabled) {
            background: linear-gradient(135deg, #357abd, #2c5f99);
            transform: translateY(-2px);
        }

        .memo-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .memo-result {
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .memo-result.success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .memo-result.failure {
            background: linear-gradient(135deg, #dc3545, #e74c3c);
            color: white;
        }

        .memo-restart {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .memo-restart:hover {
            background: linear-gradient(135deg, #20c997, #17a085);
            transform: translateY(-2px);
        }

        .story-display h3 {
            color: #4a90e2;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .tiktok-container {
            text-align: center;
        }

        /* CONTENEUR BOUTONS FIXES - COLONNE DROITE */
        .fixed-buttons-container {
            position: fixed;
            right: 20px;
            bottom: 20px;
            z-index: 200; /* Plus √©lev√© que tout le contenu */
            display: flex;
            flex-direction: column;
            gap: 12px;
            
            /* Animation flottante douce */
            animation: floatButtons 3s ease-in-out infinite;
            
            /* Performance optimization */
            will-change: transform;
            pointer-events: none; /* Le conteneur ne bloque pas les clics */
        }

        /* Animation flottante subtile */
        @keyframes floatButtons {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        /* Style commun pour les boutons */
        .social-button {
            display: block;
            text-decoration: none;
            padding: 12px 16px;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
            min-width: 140px;
            
            /* R√©active les √©v√©nements de clic */
            pointer-events: auto;
            
            /* Transitions fluides */
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Ombres et profondeur */
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.15),
                0 2px 8px rgba(0, 0, 0, 0.1);
            
            /* Backdrop blur pour effet moderne */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            
            /* Contour pour accessibilit√© */
            border: 2px solid transparent;
        }

        /* BOUTON KO-FI */
        .kofi-button-bottom {
            background: linear-gradient(135deg, #29abe0, #00b9fe);
            color: white;
            border-color: rgba(41, 171, 224, 0.3);
        }

        .kofi-button-bottom:hover {
            background: linear-gradient(135deg, #00b9fe, #0099cc);
            transform: translateY(-4px) scale(1.02);
            box-shadow: 
                0 8px 30px rgba(41, 171, 224, 0.4),
                0 4px 15px rgba(0, 0, 0, 0.2);
            color: white;
            border-color: rgba(41, 171, 224, 0.6);
        }

        .kofi-button-bottom:active {
            transform: translateY(-2px) scale(1.01);
        }

        /* BOUTON TIKTOK */
        .tiktok-button-bottom {
            background: linear-gradient(135deg, #ff0050, #ff0080);
            color: white;
            border-color: rgba(255, 0, 80, 0.3);
        }

        .tiktok-button-bottom:hover {
            background: linear-gradient(135deg, #ff0080, #e6006b);
            transform: translateY(-4px) scale(1.02);
            box-shadow: 
                0 8px 30px rgba(255, 0, 80, 0.4),
                0 4px 15px rgba(0, 0, 0, 0.2);
            color: white;
            border-color: rgba(255, 0, 80, 0.6);
        }

        .tiktok-button-bottom:active {
            transform: translateY(-2px) scale(1.01);
        }

        /* PROTECTION ANTI-CHEVAUCHEMENT */
        .container,
        .quiz-container,
        .memo-container,
        .story-display {
            /* Marge droite pour √©viter le chevauchement */
            margin-right: 0;
            padding-right: 15px;
            
            /* Espace en bas pour les boutons */
            padding-bottom: 120px;
        }

        /* Zone de s√©curit√© pour le contenu principal */
        @media (min-width: 768px) {
            .container {
                margin-right: 180px; /* Espace pour les boutons */
                padding-right: 15px;
            }
        }

        /* RESPONSIVE MOBILE */
        @media (max-width: 768px) {
            .fixed-buttons-container {
                right: 10px;
                bottom: 15px;
                gap: 10px;
                /* Animation r√©duite sur mobile */
                animation: none;
            }
            
            .social-button {
                min-width: 120px;
                padding: 10px 14px;
                font-size: 0.8rem;
                border-radius: 30px;
            }
            
            /* Moins d'espace pour mobile */
            .container,
            .quiz-container,
            .memo-container,
            .story-display {
                margin-right: 0;
                padding-bottom: 100px;
            }
            
            /* MENU RESPONSIVE - centre sur mobile */
            .category-menu {
                top: 12px;
                right: 50%;
                transform: translateX(50%);
                border-radius: 18px;
                border-width: 2px;
                /* Animation r√©duite pour mobile */
                animation: none;
            }
            
            .category-menu select {
                padding: 10px 15px;
                font-size: 14px;
                min-width: 180px;
                padding-right: 40px;
                background-size: 18px;
            }
            
            .hero-welcome {
                margin: 100px auto 30px auto; /* Ajust√© pour mobile */
                padding: 25px 20px;
                max-width: 95%;
                border-radius: 20px;
                border-width: 2px;
            }
            
            .hero-title {
                font-size: clamp(1.5rem, 6vw, 2.2rem);
                margin-bottom: 12px;
            }
            
            .hero-subtitle {
                font-size: clamp(1rem, 4vw, 1.3rem);
            }
        }

        @media (max-width: 480px) {
            .fixed-buttons-container {
                right: 8px;
                bottom: 10px;
                gap: 8px;
            }
            
            .social-button {
                min-width: 110px;
                padding: 8px 12px;
                font-size: 0.75rem;
                border-radius: 25px;
                
                /* Ombres r√©duites pour performance */
                box-shadow: 0 3px 15px rgba(0, 0, 0, 0.15);
            }
            
            .social-button:hover {
                transform: translateY(-2px) scale(1.01);
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            }
            
            /* Encore moins d'espace pour petit mobile */
            .container,
            .quiz-container,
            .memo-container,
            .story-display {
                padding-bottom: 90px;
            }
            
            .category-menu {
                top: 8px;
                right: 50%;
                transform: translateX(50%);
                border-radius: 15px;
                border-width: 2px;
            }
            
            .category-menu select {
                padding: 8px 12px;
                font-size: 13px;
                min-width: 160px;
                padding-right: 35px;
                background-size: 16px;
                font-weight: 500;
            }
            
            .hero-welcome {
                margin: 90px auto 25px auto;
                padding: 20px 15px;
                border-radius: 18px;
                max-width: 98%;
            }
            
            .hero-title {
                font-size: clamp(1.3rem, 7vw, 1.9rem);
                margin-bottom: 10px;
                letter-spacing: 0.5px;
            }
            
            .hero-subtitle {
                font-size: clamp(0.9rem, 4.5vw, 1.2rem);
            }
        }

        /* TR√àS PETITS √âCRANS (320px) */
        @media (max-width: 320px) {
            .fixed-buttons-container {
                right: 5px;
                bottom: 8px;
                gap: 6px;
            }
            
            .social-button {
                min-width: 100px;
                padding: 7px 10px;
                font-size: 0.7rem;
                border-radius: 20px;
                font-weight: 500;
            }
            
            /* Supprime les effets co√ªteux sur tr√®s petits √©crans */
            .social-button:hover {
                transform: none;
                box-shadow: 0 3px 15px rgba(0, 0, 0, 0.15);
            }
            
            .container,
            .quiz-container,
            .memo-container,
            .story-display {
                padding-bottom: 80px;
            }
            
            .category-menu {
                top: 5px;
                right: 50%;
                transform: translateX(50%);
                border-radius: 12px;
                border-width: 2px;
            }
            
            .category-menu select {
                padding: 6px 10px;
                font-size: 12px;
                min-width: 140px;
                padding-right: 30px;
                background-size: 14px;
                font-weight: 500;
            }
            
            .hero-welcome {
                margin: 80px auto 20px auto;
                padding: 18px 12px;
                border-radius: 15px;
                border-width: 2px;
            }
            
            .hero-title {
                font-size: clamp(1.2rem, 8vw, 1.7rem);
                margin-bottom: 8px;
            }
            
            .hero-subtitle {
                font-size: clamp(0.85rem, 5vw, 1.1rem);
            }
        }

        .tiktok-button {
            display: inline-block;
            background: linear-gradient(135deg, #ff0050, #ff0080);
            color: white;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(255, 0, 80, 0.4);
            border: 2px solid #ff0050;
        }

        .tiktok-button:hover {
            background: linear-gradient(135deg, #ff0080, #e6006b);
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(255, 0, 80, 0.6);
            color: white;
        }

        /* Tablettes et √©crans moyens */
        @media (max-width: 1024px) {
            .container {
                max-width: 800px;
                padding: 20px 15px;
            }

            .chapters-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 12px;
            }
        }

        /* Tablettes portrait et petits ordinateurs portables */
        @media (max-width: 768px) {
            .container {
                padding: 15px 10px;
            }

            .welcome-message {
                padding: 18px 15px;
                margin-bottom: 25px;
            }

            .welcome-message h1 {
                font-size: clamp(1.3rem, 5vw, 2rem);
            }

            .welcome-message p {
                font-size: clamp(0.9rem, 3vw, 1.1rem);
            }

            .chapters-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .chapter-button {
                padding: 12px 15px;
                font-size: 0.95rem;
            }

            .story-display, .quiz-container, .memo-container {
                padding: 20px 15px;
            }

            .kofi-button-bottom {
                bottom: 65px;
                padding: 8px 15px;
                font-size: 0.85rem;
                min-width: 140px;
            }

            .tiktok-button-bottom {
                bottom: 15px;
                padding: 8px 15px;
                font-size: 0.85rem;
                min-width: 140px;
            }

            .video-info {
                bottom: 15px;
                right: 15px;
                padding: 8px 12px;
                font-size: 0.8rem;
            }
        }

        /* iPhone 6/6S/7/8/SE2020 et √©crans similaires (375px) */
        @media (min-width: 361px) and (max-width: 414px) {
            .container {
                padding: 12px 10px;
                max-width: 100%;
            }

            .kofi-button-bottom, .tiktok-button-bottom {
                min-width: 140px;
                font-size: 0.85rem;
                padding: 8px 14px;
                border-radius: 22px;
                font-weight: 600;
            }

            .kofi-button-bottom {
                bottom: 60px;
            }

            .tiktok-button-bottom {
                bottom: 12px;
            }

            .chapters-container {
                padding: 16px 12px;
                border-radius: 10px;
            }

            .chapters-title {
                font-size: 1.2rem;
                margin-bottom: 16px;
            }

            .chapter-button {
                padding: 12px 16px;
                font-size: 0.95rem;
                border-radius: 8px;
                font-weight: 600;
                /* R√©active les hover effects pour iPhone 6 (plus puissant) */
            }

            .story-display, .quiz-container, .memo-container {
                padding: 16px 12px;
                border-radius: 10px;
            }

            .quiz-question h3 {
                font-size: 1.15rem;
                margin-bottom: 12px;
            }

            .quiz-answer {
                padding: 12px 10px;
                font-size: 0.9rem;
                border-radius: 8px;
                /* Hover effects r√©activ√©s pour meilleure UX */
            }

            .quiz-score {
                padding: 8px 16px;
                font-size: 0.9rem;
                margin-bottom: 12px;
            }

            .memo-timer {
                font-size: 1.2rem;
                padding: 12px 20px;
                border-radius: 18px;
                margin: 16px 0;
                /* Animations r√©activ√©es gr√¢ce au processeur A8 */
            }

            .memo-question h3 {
                font-size: 1.15rem;
                margin-bottom: 12px;
            }

            .memo-input {
                padding: 12px;
                font-size: 16px;
                border-radius: 8px;
            }

            .memo-submit, .quiz-restart, .memo-restart {
                padding: 12px 20px;
                font-size: 1rem;
                border-radius: 8px;
            }

            .video-info {
                bottom: 12px;
                right: 12px;
                padding: 8px 12px;
                font-size: 0.8rem;
                border-radius: 18px;
            }

            /* Optimisations grilles pour iPhone 6 */
            .chapters-grid {
                gap: 10px;
                margin-bottom: 16px;
            }

            .quiz-answers {
                gap: 10px;
            }

            /* Textes optimis√©s pour 375px */
            .final-score {
                font-size: 1.8rem !important;
            }

            .quiz-results h2 {
                font-size: 1.3rem;
            }

            .memo-result {
                font-size: 1.1rem;
                padding: 16px 12px;
            }

            /* Grid √† 2 colonnes possible sur iPhone 6 en paysage */
            @media (orientation: landscape) {
                .chapters-grid {
                    grid-template-columns: repeat(2, 1fr);
                    gap: 12px;
                }
                
                .container {
                    padding: 10px 8px;
                }
                
                .welcome-message {
                    padding: 12px 16px;
                    margin-bottom: 16px;
                }
            }
        }

        /* √âcrans entre 321px et 360px (iPhone 5C, anciens Android) */
        @media (min-width: 321px) and (max-width: 360px) {
            .container {
                padding: 10px 6px;
            }

            .kofi-button-bottom, .tiktok-button-bottom {
                min-width: 125px;
                font-size: 0.75rem;
                padding: 6px 10px;
            }

            .chapters-container {
                padding: 12px 8px;
            }

            .story-display, .quiz-container, .memo-container {
                padding: 12px 8px;
            }
        }

        /* Grandes tablettes et √©crans moyens en paysage */
        @media (min-width: 769px) and (max-width: 1199px) {
            .container {
                max-width: 850px;
            }

            .chapters-grid {
                grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            }
        }

        /* √âcrans ultra-larges */
        @media (min-width: 1400px) {
            .container {
                max-width: 1000px;
            }

            .chapters-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Vid√©o de fond qui change chaque jour -->
    <video class="video-background" autoplay muted loop id="daily-video">
        <source src="" type="video/mp4">
        Votre navigateur ne supporte pas la vid√©o HTML5.
    </video>
    
    <!-- Overlay pour am√©liorer la lisibilit√© -->
    <div class="video-overlay"></div>
    
    <!-- Info sur la vid√©o du jour -->
    <div class="video-info" id="video-info">
        üé¨ Vid√©o du jour
    </div>

    <!-- üîù Barre fixe en haut -->
    <header class="top-bar">
        <h1>1jour1histoire</h1>
        <nav class="nav-categories">
            <a href="#horreur" onclick="showCategory('horreur')">üßü Horreur</a>
            <a href="#absurde" onclick="showCategory('absurde')">ü§° Absurde</a>
            <a href="#quiz" onclick="showCategory('quiz')">üß† Quiz</a>
            <a href="#enfant" onclick="showCategory('enfant')">üßí Enfant</a>
            <a href="#fiction" onclick="showCategory('fiction')">ü™û Fiction ou R√©alit√©</a>
            <a href="#memo" onclick="showCategory('memo')">‚è±Ô∏è M√©mo 30s</a>
            <a href="#enigme" onclick="showCategory('enigme')">üîç √ânigmes</a>
        </nav>
    </header>

    <!-- Conteneur des boutons fixes en colonne droite -->
    <div class="fixed-buttons-container">
        <a href="https://ko-fi.com/1jour1histoire" 
           target="_blank" 
           class="social-button kofi-button-bottom">
            ‚òï Soutenir sur Ko-fi
        </a>

        <a href="https://www.tiktok.com/@1jour1hiistoires?_t=ZN-8x0JWagYNk6&_r=1" 
           target="_blank" 
           class="social-button tiktok-button-bottom">
            üéµ Rejoins-moi sur TikTok
        </a>
    </div>

    <div class="container">
        <div class="hero-welcome">
            <h1 class="hero-title">üìö Bienvenue sur 1jour1histoire</h1>
            <p class="hero-subtitle">Chaque jour une surprise !</p>
        </div>

        <div class="chapters-container" id="chapters-container">
            <div class="chapters-title" id="chapters-title">Chapitres disponibles</div>
            <div class="chapters-grid" id="chapters-grid">
                <!-- Chapitres g√©n√©r√©s dynamiquement -->
            </div>
            <div class="story-display" id="story-display">
                <!-- Histoire affich√©e ici -->
            </div>
        </div>


    </div>

    <script>
        const enigmeData = {
            enigmes: [
                {
                    image: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=600&fit=crop",
                    title: "Paysage de montagne",
                    questions: [
                        {
                            question: "Que voit-on principalement dans cette image ?",
                            answers: ["A) La mer", "B) Des montagnes", "C) Une ville"],
                            correct: 1
                        },
                        {
                            question: "Quelle est la couleur dominante du ciel ?",
                            answers: ["A) Gris", "B) Rose/Orange", "C) Noir"],
                            correct: 1
                        },
                        {
                            question: "√Ä quel moment de la journ√©e cette photo a-t-elle √©t√© prise ?",
                            answers: ["A) Lever/coucher de soleil", "B) Midi", "C) Minuit"],
                            correct: 0
                        }
                    ]
                },
                {
                    image: "https://images.unsplash.com/photo-1518837695005-2083093ee35b?w=800&h=600&fit=crop",
                    title: "Chien adorable",
                    questions: [
                        {
                            question: "Quel animal voit-on sur cette image ?",
                            answers: ["A) Un chat", "B) Un chien", "C) Un lapin"],
                            correct: 1
                        },
                        {
                            question: "Quelle est la couleur principale du pelage ?",
                            answers: ["A) Brun/Beige", "B) Noir", "C) Blanc"],
                            correct: 0
                        },
                        {
                            question: "O√π se trouve principalement l'animal ?",
                            answers: ["A) Dans l'eau", "B) Sur l'herbe/sol", "C) Dans un arbre"],
                            correct: 1
                        }
                    ]
                },
                {
                    image: "https://images.unsplash.com/photo-1519389950473-47ba0277781c?w=800&h=600&fit=crop",
                    title: "Bureau moderne",
                    questions: [
                        {
                            question: "Quel objet principal voit-on sur le bureau ?",
                            answers: ["A) Un ordinateur", "B) Des livres", "C) Une plante"],
                            correct: 0
                        },
                        {
                            question: "Quelle est l'ambiance g√©n√©rale de l'image ?",
                            answers: ["A) Sombre", "B) Moderne/claire", "C) Color√©e"],
                            correct: 1
                        },
                        {
                            question: "Que sugg√®re cette image ?",
                            answers: ["A) Le travail/bureau", "B) La cuisine", "C) Le sport"],
                            correct: 0
                        }
                    ]
                },
                {
                    image: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=600&fit=crop",
                    title: "Nature sauvage",
                    questions: [
                        {
                            question: "Dans quel type d'environnement sommes-nous ?",
                            answers: ["A) Urbain", "B) Naturel/sauvage", "C) Industriel"],
                            correct: 1
                        },
                        {
                            question: "Quel √©l√©ment naturel domine l'image ?",
                            answers: ["A) L'eau", "B) Les rochers/montagnes", "C) Les arbres"],
                            correct: 1
                        },
                        {
                            question: "Cette image √©voque quoi ?",
                            answers: ["A) La tranquillit√©", "B) L'agitation", "C) La peur"],
                            correct: 0
                        }
                    ]
                },
                {
                    image: "https://images.unsplash.com/photo-1551963831-b3b1ca40c98e?w=800&h=600&fit=crop",
                    title: "Petit d√©jeuner",
                    questions: [
                        {
                            question: "Que voit-on principalement sur cette image ?",
                            answers: ["A) De la nourriture", "B) Des outils", "C) Des v√™tements"],
                            correct: 0
                        },
                        {
                            question: "√Ä quel repas cette image fait-elle penser ?",
                            answers: ["A) D√Æner", "B) Petit d√©jeuner", "C) Go√ªter"],
                            correct: 1
                        },
                        {
                            question: "Quel sentiment cette image √©voque-t-elle ?",
                            answers: ["A) Tristesse", "B) Convivialit√©/chaleur", "C) Col√®re"],
                            correct: 1
                        }
                    ]
                }
            ]
        };

        let currentEnigme = {
            currentQuestion: 0,
            score: 0,
            enigmes: [],
            answered: false
        };

        const quizData = {
            questions: [
                {
                    question: "Quelle est la capitale de la France ?",
                    answers: ["Paris", "Lyon", "Marseille", "Toulouse"],
                    correct: 0
                },
                {
                    question: "Combien de continents y a-t-il sur Terre ?",
                    answers: ["5", "6", "7", "8"],
                    correct: 2
                },
                {
                    question: "Qui a √©crit 'Les Mis√©rables' ?",
                    answers: ["√âmile Zola", "Victor Hugo", "Gustave Flaubert", "Alexandre Dumas"],
                    correct: 1
                },
                {
                    question: "Quelle est la plan√®te la plus proche du Soleil ?",
                    answers: ["V√©nus", "Terre", "Mercure", "Mars"],
                    correct: 2
                },
                {
                    question: "En quelle ann√©e a eu lieu la R√©volution fran√ßaise ?",
                    answers: ["1789", "1799", "1804", "1815"],
                    correct: 0
                },
                {
                    question: "Quel est le plus grand oc√©an du monde ?",
                    answers: ["Atlantique", "Indien", "Arctique", "Pacifique"],
                    correct: 3
                },
                {
                    question: "Combien de c√¥t√©s a un hexagone ?",
                    answers: ["5", "6", "7", "8"],
                    correct: 1
                },
                {
                    question: "Qui a peint 'La Joconde' ?",
                    answers: ["Pablo Picasso", "Vincent van Gogh", "Leonardo da Vinci", "Claude Monet"],
                    correct: 2
                },
                {
                    question: "Quelle est la langue la plus parl√©e au monde ?",
                    answers: ["Anglais", "Mandarin", "Espagnol", "Hindi"],
                    correct: 1
                },
                {
                    question: "Combien de minutes y a-t-il dans une heure ?",
                    answers: ["50", "60", "70", "80"],
                    correct: 1
                }
            ]
        };

        let currentQuiz = {
            currentQuestion: 0,
            score: 0,
            questions: [],
            answered: false
        };

        const memoQuestions = {
            enfant: [
                { 
                    question: "Comment s'appelait la petite f√©e dans l'histoire ?", 
                    answers: ["A) Luna", "B) Stella", "C) Iris"], 
                    correct: 0,
                    explanation: "La petite f√©e s'appelait Luna et vivait dans un jardin magique."
                },
                { 
                    question: "Quel animal √©tait l'ami de F√©lix dans l'histoire ?", 
                    answers: ["A) Un lapin", "B) Un √©cureuil", "C) Un h√©risson"], 
                    correct: 1,
                    explanation: "F√©lix le renard avait pour ami l'√©cureuil Noisette."
                },
                { 
                    question: "Quel pouvoir avait la princesse √âtoile ?", 
                    answers: ["A) Contr√¥ler le vent", "B) Faire appara√Ætre des √©toiles filantes", "C) Parler aux animaux"], 
                    correct: 1,
                    explanation: "La princesse √âtoile pouvait faire appara√Ætre des √©toiles filantes."
                },
                { 
                    question: "Que cr√©ait L√©o le dragon au lieu de cracher du feu ?", 
                    answers: ["A) Des bulles multicolores", "B) De la fum√©e rose", "C) Des √©tincelles dor√©es"], 
                    correct: 0,
                    explanation: "L√©o cr√©ait de magnifiques bulles multicolores qui rendaient tout le monde heureux."
                },
                { 
                    question: "Que gardait la sir√®ne Perle ?", 
                    answers: ["A) Un tr√©sor sous-marin", "B) Un phare magique", "C) Une grotte secr√®te"], 
                    correct: 1,
                    explanation: "La sir√®ne Perle gardait un phare magique qui guidait les bateaux perdus."
                }
            ],
            adulte: [
                { 
                    question: "Depuis combien d'ann√©es Marie tenait-elle sa boutique ?", 
                    answers: ["A) 30 ans", "B) 40 ans", "C) 50 ans"], 
                    correct: 1,
                    explanation: "Marie tenait sa boutique de fleurs depuis 40 ans."
                },
                { 
                    question: "Quel √©tait le m√©tier de Thomas ?", 
                    answers: ["A) Architecte", "B) Ing√©nieur", "C) Menuisier"], 
                    correct: 0,
                    explanation: "Thomas √©tait architecte et maintenant √† la retraite."
                },
                { 
                    question: "Quel type d'√©tablissement Sophie a-t-elle ouvert ?", 
                    answers: ["A) Une boulangerie", "B) Un caf√©-librairie", "C) Une galerie d'art"], 
                    correct: 1,
                    explanation: "Sophie a quitt√© son travail de cadre pour ouvrir un caf√©-librairie."
                },
                { 
                    question: "Apr√®s combien d'ann√©es Jean a-t-il retrouv√© son premier amour ?", 
                    answers: ["A) 25 ans", "B) 30 ans", "C) 35 ans"], 
                    correct: 1,
                    explanation: "Jean a retrouv√© son premier amour apr√®s 30 ans lors d'une r√©union d'anciens √©l√®ves."
                },
                { 
                    question: "Quel √©tait le m√©tier d'√âlise ?", 
                    answers: ["A) Journaliste", "B) Photographe", "C) R√©alisatrice"], 
                    correct: 1,
                    explanation: "√âlise √©tait photographe de guerre avant de se reconvertir."
                }
            ],
            religion: [
                { 
                    question: "Comment s'appelait le fr√®re du monast√®re ?", 
                    answers: ["A) Antoine", "B) Fran√ßois", "C) Bernard"], 
                    correct: 0,
                    explanation: "Le fr√®re Antoine passait ses journ√©es √† copier des manuscrits anciens."
                },
                { 
                    question: "Comment s'appelait la jeune femme en p√®lerinage ?", 
                    answers: ["A) Marie", "B) Sarah", "C) Claire"], 
                    correct: 1,
                    explanation: "Sarah √©tait la jeune femme en qu√™te de spiritualit√© qui entreprit un p√®lerinage √† pied."
                },
                { 
                    question: "Comment s'appelait le cur√© du village ?", 
                    answers: ["A) Pierre", "B) Michel", "C) Paul"], 
                    correct: 1,
                    explanation: "Le p√®re Michel √©tait le cur√© d'un village isol√©."
                },
                { 
                    question: "Comment s'appelait le rabbin ?", 
                    answers: ["A) Samuel", "B) David", "C) Isaac"], 
                    correct: 1,
                    explanation: "Le rabbin David organisait des d√Æners pour les personnes seules dans sa synagogue."
                },
                { 
                    question: "Comment s'appelait la jeune musulmane ?", 
                    answers: ["A) Fatima", "B) Amina", "C) Aicha"], 
                    correct: 1,
                    explanation: "Amina √©tait la jeune musulmane qui luttait pour concilier sa foi et sa vie moderne."
                }
            ]
        };

        let currentMemo = {
            category: '',
            chapter: 0,
            question: {},
            timer: null,
            timeLeft: 30,
            phase: 'reading', // 'reading', 'questioning', 'finished'
            answered: false
        };

        const stories = {
            enfant: {
                title: "Histoires pour Enfants - Quiz",
                chapters: {
                    1: {
                        story: "Il √©tait une fois une petite f√©e nomm√©e Luna qui vivait dans un jardin magique. Un jour, elle d√©couvrit que toutes les fleurs avaient perdu leurs couleurs. Avec l'aide de ses amis les papillons, elle partit √† la recherche de l'arc-en-ciel perdu pour redonner vie √† son jardin.",
                        questions: [
                            {
                                question: "Comment s'appelait la petite f√©e de l'histoire ?",
                                answers: ["A) Luna", "B) Stella", "C) Aurora"],
                                correct: 0,
                                explanation: "La petite f√©e s'appelait Luna et vivait dans un jardin magique."
                            },
                            {
                                question: "Que d√©couvrit Luna dans son jardin ?",
                                answers: ["A) Que les fleurs √©taient fan√©es", "B) Que les fleurs avaient perdu leurs couleurs", "C) Que les fleurs parlaient"],
                                correct: 1,
                                explanation: "Luna d√©couvrit que toutes les fleurs avaient perdu leurs couleurs."
                            },
                            {
                                question: "Qui aida Luna dans sa qu√™te ?",
                                answers: ["A) Les oiseaux", "B) Les papillons", "C) Les abeilles"],
                                correct: 1,
                                explanation: "Luna partit √† la recherche de l'arc-en-ciel avec l'aide de ses amis les papillons."
                            }
                        ]
                    },
                    2: {
                        story: "Dans une for√™t enchant√©e, un petit renard curieux nomm√© F√©lix d√©couvrit une carte au tr√©sor. Il d√©cida de partir √† l'aventure avec son ami l'√©cureuil Noisette. Ensemble, ils apprirent que le v√©ritable tr√©sor √©tait leur amiti√©.",
                        questions: [
                            {
                                question: "Comment s'appelait le petit renard ?",
                                answers: ["A) F√©lix", "B) Oscar", "C) Roux"],
                                correct: 0,
                                explanation: "Le petit renard curieux s'appelait F√©lix."
                            },
                            {
                                question: "Qu'est-ce que F√©lix d√©couvrit ?",
                                answers: ["A) Un livre magique", "B) Une carte au tr√©sor", "C) Une grotte secr√®te"],
                                correct: 1,
                                explanation: "F√©lix d√©couvrit une carte au tr√©sor dans la for√™t enchant√©e."
                            },
                            {
                                question: "Quel √©tait le v√©ritable tr√©sor d√©couvert ?",
                                answers: ["A) De l'or", "B) Des pierres pr√©cieuses", "C) L'amiti√©"],
                                correct: 2,
                                explanation: "F√©lix et Noisette apprirent que le v√©ritable tr√©sor √©tait leur amiti√©."
                            }
                        ]
                    },
                    3: {
                        story: "La princesse √âtoile avait un pouvoir sp√©cial : elle pouvait faire appara√Ætre des √©toiles filantes. Un soir, elle remarqua qu'un petit village √©tait triste car ils n'avaient jamais vu d'√©toiles. Elle d√©cida de leur offrir la plus belle nuit √©toil√©e de leur vie.",
                        questions: [
                            {
                                question: "Quel √©tait le pouvoir de la princesse √âtoile ?",
                                answers: ["A) Contr√¥ler le vent", "B) Faire appara√Ætre des √©toiles filantes", "C) Parler aux animaux"],
                                correct: 1,
                                explanation: "La princesse √âtoile pouvait faire appara√Ætre des √©toiles filantes."
                            },
                            {
                                question: "Pourquoi le village √©tait-il triste ?",
                                answers: ["A) Il pleuvait toujours", "B) Ils n'avaient jamais vu d'√©toiles", "C) Ils √©taient pauvres"],
                                correct: 1,
                                explanation: "Le petit village √©tait triste car ses habitants n'avaient jamais vu d'√©toiles."
                            },
                            {
                                question: "Que d√©cida de faire la princesse ?",
                                answers: ["A) Partir en voyage", "B) Offrir la plus belle nuit √©toil√©e", "C) Construire un ch√¢teau"],
                                correct: 1,
                                explanation: "La princesse d√©cida d'offrir au village la plus belle nuit √©toil√©e de leur vie."
                            }
                        ]
                    },
                    4: {
                        story: "L√©o le petit dragon ne savait pas cracher du feu comme les autres dragons. Il √©tait tr√®s triste jusqu'au jour o√π il d√©couvrit qu'il pouvait cr√©er de magnifiques bulles multicolores qui rendaient tout le monde heureux.",
                        questions: [
                            {
                                question: "Que ne savait pas faire L√©o comme les autres dragons ?",
                                answers: ["A) Voler", "B) Cracher du feu", "C) Rugir"],
                                correct: 1,
                                explanation: "L√©o ne savait pas cracher du feu comme les autres dragons."
                            },
                            {
                                question: "Que d√©couvrit L√©o qu'il savait faire ?",
                                answers: ["A) Cr√©er des bulles multicolores", "B) Chanter", "C) Danser"],
                                correct: 0,
                                explanation: "L√©o d√©couvrit qu'il pouvait cr√©er de magnifiques bulles multicolores."
                            },
                            {
                                question: "Quel effet avaient les bulles de L√©o ?",
                                answers: ["A) Elles explosaient", "B) Elles rendaient tout le monde heureux", "C) Elles sentaient bon"],
                                correct: 1,
                                explanation: "Les bulles multicolores de L√©o rendaient tout le monde heureux."
                            }
                        ]
                    },
                    5: {
                        story: "Dans un royaume sous-marin, la sir√®ne Perle gardait un phare magique qui guidait les bateaux perdus. Quand une terrible temp√™te √©teignit sa lumi√®re, elle dut faire appel au courage de tous les poissons pour rallumer l'espoir.",
                        questions: [
                            {
                                question: "Que gardait la sir√®ne Perle ?",
                                answers: ["A) Un tr√©sor", "B) Un phare magique", "C) Un palais"],
                                correct: 1,
                                explanation: "La sir√®ne Perle gardait un phare magique sous-marin."
                            },
                            {
                                question: "√Ä quoi servait le phare magique ?",
                                answers: ["A) √Ä √©clairer le royaume", "B) √Ä guider les bateaux perdus", "C) √Ä effrayer les ennemis"],
                                correct: 1,
                                explanation: "Le phare magique guidait les bateaux perdus."
                            },
                            {
                                question: "Qui aida Perle √† rallumer l'espoir ?",
                                answers: ["A) Les dauphins", "B) Tous les poissons", "C) Les baleines"],
                                correct: 1,
                                explanation: "Perle fit appel au courage de tous les poissons pour rallumer l'espoir."
                            }
                        ]
                    }
                }
            },
            adulte: {
                title: "Histoires pour Adultes - Quiz",
                chapters: {
                    1: {
                        story: "Marie ferma sa boutique de fleurs pour la derni√®re fois apr√®s 40 ans. En rangeant, elle d√©couvrit une lettre cach√©e depuis des d√©cennies. Cette lettre allait changer sa perspective sur toute sa vie et lui r√©v√©ler un secret gard√© par sa grand-m√®re.",
                        questions: [
                            {
                                question: "Depuis combien de temps Marie tenait-elle sa boutique ?",
                                answers: ["A) 30 ans", "B) 40 ans", "C) 50 ans"],
                                correct: 1,
                                explanation: "Marie ferma sa boutique de fleurs apr√®s 40 ans d'activit√©."
                            },
                            {
                                question: "Que d√©couvrit Marie en rangeant ?",
                                answers: ["A) Un journal intime", "B) Une lettre cach√©e", "C) Une photo ancienne"],
                                correct: 1,
                                explanation: "En rangeant, Marie d√©couvrit une lettre cach√©e depuis des d√©cennies."
                            },
                            {
                                question: "Qui avait gard√© le secret r√©v√©l√© par la lettre ?",
                                answers: ["A) Sa m√®re", "B) Sa grand-m√®re", "C) Sa s≈ìur"],
                                correct: 1,
                                explanation: "La lettre r√©v√©lait un secret gard√© par sa grand-m√®re."
                            }
                        ]
                    },
                    2: {
                        story: "Thomas, architecte √† la retraite, d√©cida de construire une petite cabane dans les bois. Ce projet simple devint une qu√™te de sens qui le reconnecta avec la nature et avec lui-m√™me, lui apprenant que les plus belles cr√©ations naissent de la simplicit√©.",
                        questions: [
                            {
                                question: "Quel √©tait le m√©tier de Thomas ?",
                                answers: ["A) Architecte", "B) Ing√©nieur", "C) Menuisier"],
                                correct: 0,
                                explanation: "Thomas √©tait architecte et maintenant √† la retraite."
                            },
                            {
                                question: "Que d√©cida de construire Thomas ?",
                                answers: ["A) Une maison", "B) Une cabane dans les bois", "C) Un garage"],
                                correct: 1,
                                explanation: "Thomas d√©cida de construire une petite cabane dans les bois."
                            },
                            {
                                question: "Que lui apprit ce projet ?",
                                answers: ["A) Que le travail est difficile", "B) Que les plus belles cr√©ations naissent de la simplicit√©", "C) Qu'il √©tait trop vieux"],
                                correct: 1,
                                explanation: "Ce projet lui apprit que les plus belles cr√©ations naissent de la simplicit√©."
                            }
                        ]
                    },
                    3: {
                        story: "√Ä 50 ans, Sophie quitta son travail de cadre pour ouvrir un caf√©-librairie. Cette d√©cision bouleversa sa vie et celle de son quartier, prouvant qu'il n'est jamais trop tard pour suivre ses r√™ves et cr√©er du lien social.",
                        questions: [
                            {
                                question: "√Ä quel √¢ge Sophie changea-t-elle de vie ?",
                                answers: ["A) 45 ans", "B) 50 ans", "C) 55 ans"],
                                correct: 1,
                                explanation: "Sophie avait 50 ans quand elle quitta son travail de cadre."
                            },
                            {
                                question: "Qu'ouvrit Sophie apr√®s avoir quitt√© son travail ?",
                                answers: ["A) Un restaurant", "B) Un caf√©-librairie", "C) Une boutique"],
                                correct: 1,
                                explanation: "Sophie ouvrit un caf√©-librairie apr√®s avoir quitt√© son travail de cadre."
                            },
                            {
                                question: "Que prouva la d√©cision de Sophie ?",
                                answers: ["A) Que l'argent ne fait pas le bonheur", "B) Qu'il n'est jamais trop tard pour suivre ses r√™ves", "C) Que le travail est important"],
                                correct: 1,
                                explanation: "Sa d√©cision prouva qu'il n'est jamais trop tard pour suivre ses r√™ves."
                            }
                        ]
                    },
                    4: {
                        story: "Jean retrouva par hasard son premier amour apr√®s 30 ans lors d'une r√©union d'anciens √©l√®ves. Leur conversation d'une nuit leur fit comprendre que certaines connexions transcendent le temps et les circonstances de la vie.",
                        questions: [
                            {
                                question: "Apr√®s combien d'ann√©es Jean retrouva-t-il son premier amour ?",
                                answers: ["A) 25 ans", "B) 30 ans", "C) 35 ans"],
                                correct: 1,
                                explanation: "Jean retrouva son premier amour apr√®s 30 ans."
                            },
                            {
                                question: "O√π se retrouv√®rent-ils ?",
                                answers: ["A) Dans un caf√©", "B) √Ä une r√©union d'anciens √©l√®ves", "C) Dans la rue"],
                                correct: 1,
                                explanation: "Ils se retrouv√®rent lors d'une r√©union d'anciens √©l√®ves."
                            },
                            {
                                question: "Que leur fit comprendre leur conversation ?",
                                answers: ["A) Qu'ils avaient chang√©", "B) Que certaines connexions transcendent le temps", "C) Qu'ils √©taient trop vieux"],
                                correct: 1,
                                explanation: "Leur conversation leur fit comprendre que certaines connexions transcendent le temps."
                            }
                        ]
                    },
                    5: {
                        story: "√âlise, photographe de guerre fatigu√©e, d√©cida de documenter la beaut√© ordinaire de sa ville natale. Ce projet artistique la gu√©rit de ses traumatismes et lui redonna foi en l'humanit√© √† travers les petits gestes du quotidien.",
                        questions: [
                            {
                                question: "Quel √©tait le m√©tier d'√âlise ?",
                                answers: ["A) Journaliste", "B) Photographe de guerre", "C) Artiste"],
                                correct: 1,
                                explanation: "√âlise √©tait photographe de guerre et se sentait fatigu√©e."
                            },
                            {
                                question: "Que d√©cida de documenter √âlise ?",
                                answers: ["A) Les conflits", "B) La beaut√© ordinaire de sa ville", "C) Les c√©l√©brit√©s"],
                                correct: 1,
                                explanation: "√âlise d√©cida de documenter la beaut√© ordinaire de sa ville natale."
                            },
                            {
                                question: "Quel effet eut ce projet sur √âlise ?",
                                answers: ["A) Il l'ennuya", "B) Il la gu√©rit et lui redonna foi en l'humanit√©", "C) Il la rendit triste"],
                                correct: 1,
                                explanation: "Ce projet la gu√©rit de ses traumatismes et lui redonna foi en l'humanit√©."
                            }
                        ]
                    }
                }
            },
            religion: {
                title: "Histoires Religieuses - Quiz",
                chapters: {
                    1: {
                        story: "Dans un petit monast√®re, le fr√®re Antoine passait ses journ√©es √† copier des manuscrits anciens. Un jour, il d√©couvrit entre les pages d'un livre saint une pri√®re oubli√©e qui apportait une paix profonde √† tous ceux qui la r√©citaient.",
                        questions: [
                            {
                                question: "Comment s'appelait le fr√®re du monast√®re ?",
                                answers: ["A) Antoine", "B) Fran√ßois", "C) Bernard"],
                                correct: 0,
                                explanation: "Le fr√®re Antoine passait ses journ√©es √† copier des manuscrits anciens."
                            },
                            {
                                question: "Que faisait le fr√®re Antoine chaque jour ?",
                                answers: ["A) Il priait", "B) Il copiait des manuscrits", "C) Il jardinait"],
                                correct: 1,
                                explanation: "Le fr√®re Antoine passait ses journ√©es √† copier des manuscrits anciens."
                            },
                            {
                                question: "Que d√©couvrit-il dans un livre saint ?",
                                answers: ["A) Une illustration", "B) Une pri√®re oubli√©e", "C) Une carte"],
                                correct: 1,
                                explanation: "Il d√©couvrit une pri√®re oubli√©e qui apportait une paix profonde."
                            }
                        ]
                    },
                    2: {
                        story: "Sarah, jeune femme en qu√™te de spiritualit√©, entreprit un p√®lerinage √† pied. Chaque √©tape de son voyage lui enseigna une nouvelle le√ßon sur la foi, la pers√©v√©rance et la g√©n√©rosit√© des √¢mes qu'elle rencontrait sur son chemin.",
                        questions: [
                            {
                                question: "Comment s'appelait la jeune femme ?",
                                answers: ["A) Marie", "B) Sarah", "C) Claire"],
                                correct: 1,
                                explanation: "Sarah √©tait une jeune femme en qu√™te de spiritualit√©."
                            },
                            {
                                question: "Comment entreprit-elle son p√®lerinage ?",
                                answers: ["A) En voiture", "B) √Ä pied", "C) √Ä v√©lo"],
                                correct: 1,
                                explanation: "Sarah entreprit un p√®lerinage √† pied."
                            },
                            {
                                question: "Que lui enseigna chaque √©tape ?",
                                answers: ["A) La patience", "B) Des le√ßons sur la foi et la pers√©v√©rance", "C) L'humilit√©"],
                                correct: 1,
                                explanation: "Chaque √©tape lui enseigna des le√ßons sur la foi, la pers√©v√©rance et la g√©n√©rosit√©."
                            }
                        ]
                    },
                    3: {
                        story: "Le p√®re Michel, cur√© d'un village isol√©, vit sa foi √©branl√©e par les difficult√©s de ses paroissiens. C'est en aidant une famille dans le besoin qu'il red√©couvrit le v√©ritable sens de sa vocation et la force de la communaut√©.",
                        questions: [
                            {
                                question: "Comment s'appelait le cur√© ?",
                                answers: ["A) Pierre", "B) Michel", "C) Paul"],
                                correct: 1,
                                explanation: "Le p√®re Michel √©tait cur√© d'un village isol√©."
                            },
                            {
                                question: "Qu'est-ce qui √©branla sa foi ?",
                                answers: ["A) Une maladie", "B) Les difficult√©s de ses paroissiens", "C) Une dispute"],
                                correct: 1,
                                explanation: "Sa foi fut √©branl√©e par les difficult√©s de ses paroissiens."
                            },
                            {
                                question: "Comment red√©couvrit-il sa vocation ?",
                                answers: ["A) En priant", "B) En aidant une famille dans le besoin", "C) En voyageant"],
                                correct: 1,
                                explanation: "Il red√©couvrit sa vocation en aidant une famille dans le besoin."
                            }
                        ]
                    },
                    4: {
                        story: "Dans une synagogue centenaire, le rabbin David organisait chaque vendredi un d√Æner pour les personnes seules. Ces repas partag√©s cr√©√®rent des liens profonds et montr√®rent comment les traditions peuvent rassembler au-del√† des diff√©rences.",
                        questions: [
                            {
                                question: "Comment s'appelait le rabbin ?",
                                answers: ["A) Samuel", "B) David", "C) Isaac"],
                                correct: 1,
                                explanation: "Le rabbin David organisait des d√Æners dans sa synagogue."
                            },
                            {
                                question: "Que faisait le rabbin chaque vendredi ?",
                                answers: ["A) Il priait seul", "B) Il organisait un d√Æner pour les personnes seules", "C) Il √©tudiait"],
                                correct: 1,
                                explanation: "Chaque vendredi, il organisait un d√Æner pour les personnes seules."
                            },
                            {
                                question: "Que montr√®rent ces repas partag√©s ?",
                                answers: ["A) L'importance de la nourriture", "B) Comment les traditions peuvent rassembler", "C) La richesse de la communaut√©"],
                                correct: 1,
                                explanation: "Ces repas montr√®rent comment les traditions peuvent rassembler au-del√† des diff√©rences."
                            }
                        ]
                    },
                    5: {
                        story: "Amina, jeune musulmane, luttait pour concilier sa foi et sa vie moderne. √Ä travers les enseignements de sa grand-m√®re et la m√©ditation, elle apprit que la spiritualit√© peut s'√©panouir dans tous les aspects de la vie quotidienne.",
                        questions: [
                            {
                                question: "Comment s'appelait la jeune musulmane ?",
                                answers: ["A) Fatima", "B) Amina", "C) Aicha"],
                                correct: 1,
                                explanation: "Amina √©tait une jeune musulmane en qu√™te d'√©quilibre."
                            },
                            {
                                question: "Avec quoi luttait-elle ?",
                                answers: ["A) Sa famille", "B) Concilier sa foi et sa vie moderne", "C) Ses √©tudes"],
                                correct: 1,
                                explanation: "Amina luttait pour concilier sa foi et sa vie moderne."
                            },
                            {
                                question: "Qu'apprit-elle gr√¢ce √† sa grand-m√®re ?",
                                answers: ["A) Que la foi est difficile", "B) Que la spiritualit√© peut s'√©panouir partout", "C) Qu'il faut √™tre parfaite"],
                                correct: 1,
                                explanation: "Elle apprit que la spiritualit√© peut s'√©panouir dans tous les aspects de la vie quotidienne."
                            }
                        ]
                    }
                }
            }
        };

        const categorySelect = document.getElementById('category');
        const chaptersContainer = document.getElementById('chapters-container');
        const chaptersTitle = document.getElementById('chapters-title');
        const chaptersGrid = document.getElementById('chapters-grid');
        const storyDisplay = document.getElementById('story-display');

        // Nouvelle fonction pour g√©rer les clics de navigation
        function showCategory(category) {
            // Emp√™cher le comportement par d√©faut du lien
            event.preventDefault();
            
            if (category === 'quiz') {
                showQuiz();
                return;
            }
            
            if (category === 'memo') {
                showMemo();
                return;
            }
            
            if (category === 'enigme') {
                showEnigme();
                return;
            }
            
            // V√©rifier si la cat√©gorie existe dans nos histoires
            if (stories[category]) {
                showChapters(category);
            } else {
                // Pour les nouvelles cat√©gories (horreur, absurde, fiction)
                showPlaceholder(category);
            }
        }

        function showPlaceholder(category) {
            const categoryNames = {
                'horreur': 'üßü Histoires d\'Horreur',
                'absurde': 'ü§° Histoires Absurdes', 
                'fiction': 'ü™û Fiction ou R√©alit√©'
            };
            
            chaptersTitle.textContent = categoryNames[category] || 'Nouvelle cat√©gorie';
            
            chaptersGrid.innerHTML = `
                <div class="quiz-container">
                    <h2 style="color: #4a90e2; margin-bottom: 20px;">${categoryNames[category]}</h2>
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="font-size: 4rem; margin-bottom: 20px;">üöß</div>
                        <h3 style="color: #ffc107; margin-bottom: 15px;">Contenu en cours de d√©veloppement</h3>
                        <p style="color: white; font-size: 1.1rem; line-height: 1.6;">
                            Cette section sera bient√¥t disponible avec de nouvelles histoires passionnantes !
                        </p>
                        <div style="margin-top: 30px;">
                            <button class="memo-submit" onclick="hideChapters()">
                                üîô Retour au menu principal
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            chaptersGrid.style.display = 'block';
            storyDisplay.classList.remove('show');
            
            setTimeout(() => {
                chaptersContainer.classList.add('show');
            }, 100);
        }

        function showChapters(category) {
            if (category === 'quiz') {
                showQuiz();
                return;
            }
            
            if (category === 'memo') {
                showMemo();
                return;
            }
            
            if (category === 'enigme') {
                showEnigme();
                return;
            }
            
            const categoryData = stories[category];
            
            // Mise √† jour du titre
            chaptersTitle.textContent = categoryData.title;
            
            // Cr√©ation des boutons de chapitres
            chaptersGrid.innerHTML = '';
            for (let i = 1; i <= 5; i++) {
                const button = document.createElement('button');
                button.className = 'chapter-button';
                button.textContent = `Chapitre ${i}`;
                button.addEventListener('click', () => showStory(category, i));
                chaptersGrid.appendChild(button);
            }
            
            // Masquer l'histoire pr√©c√©dente
            storyDisplay.classList.remove('show');
            
            // Afficher les chapitres avec animation
            setTimeout(() => {
                chaptersContainer.classList.add('show');
            }, 100);
        }

        function hideChapters() {
            chaptersContainer.classList.remove('show');
            storyDisplay.classList.remove('show');
        }

        function showStory(category, chapterNumber) {
            // Initialiser le quiz de l'histoire
            currentStory = {
                category: category,
                chapter: chapterNumber,
                currentQuestion: 0,
                score: 0,
                answered: false,
                data: stories[category].chapters[chapterNumber]
            };
            
            // Afficher l'histoire puis commencer le quiz
            showStoryReading();
        }

        let currentStory = {
            category: '',
            chapter: 0,
            currentQuestion: 0,
            score: 0,
            answered: false,
            data: {}
        };

        function showStoryReading() {
            storyDisplay.innerHTML = `
                <div class="quiz-container">
                    <h2 style="color: #4a90e2; margin-bottom: 20px;">üìñ Chapitre ${currentStory.chapter}</h2>
                    <p style="color: #ffc107; font-weight: 600; margin-bottom: 20px;">
                        Lisez attentivement cette histoire, puis r√©pondez aux questions !
                    </p>
                    
                    <div class="memo-story">
                        <p style="line-height: 1.8; font-size: 1.1rem;">${currentStory.data.story}</p>
                    </div>
                    
                    <div style="text-align: center; margin-top: 25px;">
                        <button class="memo-submit" onclick="startStoryQuiz()">
                            üß† Commencer le quiz sur cette histoire
                        </button>
                    </div>
                </div>
            `;
            
            // Masquer puis afficher avec animation
            storyDisplay.classList.remove('show');
            setTimeout(() => {
                storyDisplay.classList.add('show');
            }, 100);
        }

        function startStoryQuiz() {
            createStoryQuizInterface();
        }

        function createStoryQuizInterface() {
            const currentQuestion = currentStory.data.questions[currentStory.currentQuestion];
            
            storyDisplay.innerHTML = `
                <div class="quiz-container">
                    <div class="quiz-header">
                        <div class="quiz-score">
                            Score: <span id="current-story-score">${currentStory.score}</span>/${currentStory.data.questions.length}
                        </div>
                        <div style="color: #4a90e2; font-weight: 600;">
                            Question <span id="story-question-number">${currentStory.currentQuestion + 1}</span> sur ${currentStory.data.questions.length}
                        </div>
                    </div>
                    
                    <div class="quiz-question">
                        <h3 id="story-question-text">${currentQuestion.question}</h3>
                        <div class="quiz-answers" id="story-answers">
                            ${currentQuestion.answers.map((answer, index) => 
                                `<button class="quiz-answer" onclick="selectStoryAnswer(${index})">${answer}</button>`
                            ).join('')}
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <button class="quiz-next" id="story-next-button" onclick="nextStoryQuestion()">
                            ${currentStory.currentQuestion < currentStory.data.questions.length - 1 ? 'Question suivante' : 'Voir les r√©sultats'}
                        </button>
                    </div>
                    
                    <div id="story-explanation" style="display: none; background: rgba(74, 144, 226, 0.1); padding: 15px; border-radius: 8px; margin-top: 15px; border: 1px solid #4a90e2;">
                        <p style="color: #4a90e2; font-weight: 600; margin-bottom: 8px;">üí° Explication :</p>
                        <p style="color: white; font-size: 0.95rem;"></p>
                    </div>
                </div>
            `;
        }

        function selectStoryAnswer(selectedIndex) {
            if (currentStory.answered) return;
            
            currentStory.answered = true;
            const correctIndex = currentStory.data.questions[currentStory.currentQuestion].correct;
            const answers = document.querySelectorAll('.quiz-answer');
            const explanation = currentStory.data.questions[currentStory.currentQuestion].explanation;
            
            answers.forEach((answer, index) => {
                answer.classList.add('disabled');
                if (index === correctIndex) {
                    answer.classList.add('correct');
                } else if (index === selectedIndex) {
                    answer.classList.add('wrong');
                }
            });
            
            if (selectedIndex === correctIndex) {
                currentStory.score++;
                document.getElementById('current-story-score').textContent = currentStory.score;
            }
            
            // Afficher l'explication
            const explanationDiv = document.getElementById('story-explanation');
            explanationDiv.querySelector('p:last-child').textContent = explanation;
            explanationDiv.style.display = 'block';
            
            document.getElementById('story-next-button').classList.add('show');
        }

        function nextStoryQuestion() {
            currentStory.currentQuestion++;
            currentStory.answered = false;
            
            if (currentStory.currentQuestion < currentStory.data.questions.length) {
                // Question suivante
                const currentQuestion = currentStory.data.questions[currentStory.currentQuestion];
                
                document.getElementById('story-question-number').textContent = currentStory.currentQuestion + 1;
                document.getElementById('story-question-text').textContent = currentQuestion.question;
                
                const answersContainer = document.getElementById('story-answers');
                answersContainer.innerHTML = currentQuestion.answers.map((answer, index) => 
                    `<button class="quiz-answer" onclick="selectStoryAnswer(${index})">${answer}</button>`
                ).join('');
                
                const nextButton = document.getElementById('story-next-button');
                nextButton.classList.remove('show');
                nextButton.textContent = currentStory.currentQuestion < currentStory.data.questions.length - 1 ? 'Question suivante' : 'Voir les r√©sultats';
                
                // Masquer l'explication pr√©c√©dente
                document.getElementById('story-explanation').style.display = 'none';
            } else {
                // Afficher les r√©sultats
                showStoryResults();
            }
        }

        function showStoryResults() {
            const percentage = Math.round((currentStory.score / currentStory.data.questions.length) * 100);
            let scoreClass, message;
            
            if (percentage >= 80) {
                scoreClass = 'score-excellent';
                message = "üìö Excellent ! Vous avez bien retenu l'histoire !";
            } else if (percentage >= 60) {
                scoreClass = 'score-good';
                message = "üëç Bien jou√© ! Bonne compr√©hension de l'histoire !";
            } else {
                scoreClass = 'score-needs-improvement';
                message = "üìñ Relisez l'histoire pour mieux la retenir !";
            }
            
            storyDisplay.innerHTML = `
                <div class="quiz-results">
                    <h2>üèÜ R√©sultats du Chapitre ${currentStory.chapter}</h2>
                    <div class="final-score ${scoreClass}">
                        ${currentStory.score}/${currentStory.data.questions.length}
                    </div>
                    <div class="final-score ${scoreClass}">
                        ${percentage}%
                    </div>
                    <p style="font-size: 1.2rem; margin: 20px 0; color: white;">
                        ${message}
                    </p>
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                        <button class="quiz-restart" onclick="showStoryReading()">
                            üìñ Relire l'histoire
                        </button>
                        <button class="quiz-restart" onclick="startStoryQuiz()" style="background: linear-gradient(135deg, #4a90e2, #357abd);">
                            üîÑ Refaire le quiz
                        </button>
                    </div>
                </div>
            `;
        }

        function showQuiz() {
            // Initialiser le quiz
            currentQuiz.currentQuestion = 0;
            currentQuiz.score = 0;
            currentQuiz.questions = [...quizData.questions].sort(() => Math.random() - 0.5).slice(0, 5);
            currentQuiz.answered = false;
            
            // Mise √† jour du titre
            chaptersTitle.textContent = "üß† Quiz Interactif - Testez vos connaissances !";
            
            // Masquer les boutons de chapitres
            chaptersGrid.style.display = 'none';
            
            // Masquer l'histoire pr√©c√©dente
            storyDisplay.classList.remove('show');
            
            // Cr√©er l'interface de quiz
            createQuizInterface();
            
            // Afficher le conteneur avec animation
            setTimeout(() => {
                chaptersContainer.classList.add('show');
            }, 100);
        }

        function createQuizInterface() {
            chaptersGrid.innerHTML = `
                <div class="quiz-container">
                    <div class="quiz-header">
                        <div class="quiz-score">
                            Score: <span id="current-score">${currentQuiz.score}</span>/${currentQuiz.questions.length}
                        </div>
                        <div style="color: #4a90e2; font-weight: 600;">
                            Question <span id="question-number">${currentQuiz.currentQuestion + 1}</span> sur ${currentQuiz.questions.length}
                        </div>
                    </div>
                    
                    <div class="quiz-question">
                        <h3 id="question-text">${currentQuiz.questions[currentQuiz.currentQuestion].question}</h3>
                        <div class="quiz-answers" id="quiz-answers">
                            ${currentQuiz.questions[currentQuiz.currentQuestion].answers.map((answer, index) => 
                                `<button class="quiz-answer" onclick="selectAnswer(${index})">${answer}</button>`
                            ).join('')}
                        </div>
                    </div>
                    
                    <div style="text-align: center;">
                        <button class="quiz-next" id="next-button" onclick="nextQuestion()">
                            ${currentQuiz.currentQuestion < currentQuiz.questions.length - 1 ? 'Question suivante' : 'Voir les r√©sultats'}
                        </button>
                    </div>
                </div>
            `;
            chaptersGrid.style.display = 'block';
        }

        function selectAnswer(selectedIndex) {
            if (currentQuiz.answered) return;
            
            currentQuiz.answered = true;
            const correctIndex = currentQuiz.questions[currentQuiz.currentQuestion].correct;
            const answers = document.querySelectorAll('.quiz-answer');
            
            answers.forEach((answer, index) => {
                answer.classList.add('disabled');
                if (index === correctIndex) {
                    answer.classList.add('correct');
                } else if (index === selectedIndex) {
                    answer.classList.add('wrong');
                }
            });
            
            if (selectedIndex === correctIndex) {
                currentQuiz.score++;
                document.getElementById('current-score').textContent = currentQuiz.score;
            }
            
            document.getElementById('next-button').classList.add('show');
        }

        function nextQuestion() {
            currentQuiz.currentQuestion++;
            currentQuiz.answered = false;
            
            if (currentQuiz.currentQuestion < currentQuiz.questions.length) {
                // Question suivante
                document.getElementById('question-number').textContent = currentQuiz.currentQuestion + 1;
                document.getElementById('question-text').textContent = currentQuiz.questions[currentQuiz.currentQuestion].question;
                
                const answersContainer = document.getElementById('quiz-answers');
                answersContainer.innerHTML = currentQuiz.questions[currentQuiz.currentQuestion].answers.map((answer, index) => 
                    `<button class="quiz-answer" onclick="selectAnswer(${index})">${answer}</button>`
                ).join('');
                
                const nextButton = document.getElementById('next-button');
                nextButton.classList.remove('show');
                nextButton.textContent = currentQuiz.currentQuestion < currentQuiz.questions.length - 1 ? 'Question suivante' : 'Voir les r√©sultats';
            } else {
                // Afficher les r√©sultats
                showQuizResults();
            }
        }

        function showQuizResults() {
            const percentage = Math.round((currentQuiz.score / currentQuiz.questions.length) * 100);
            let scoreClass, message;
            
            if (percentage >= 80) {
                scoreClass = 'score-excellent';
                message = "üéâ Excellent ! Vous ma√Ætrisez bien vos connaissances !";
            } else if (percentage >= 60) {
                scoreClass = 'score-good';
                message = "üëç Bien jou√© ! Vous avez de bonnes connaissances !";
            } else {
                scoreClass = 'score-needs-improvement';
                message = "üí™ Continuez √† apprendre, vous progresserez !";
            }
            
            chaptersGrid.innerHTML = `
                <div class="quiz-results">
                    <h2>üèÜ R√©sultats du Quiz</h2>
                    <div class="final-score ${scoreClass}">
                        ${currentQuiz.score}/${currentQuiz.questions.length}
                    </div>
                    <div class="final-score ${scoreClass}">
                        ${percentage}%
                    </div>
                    <p style="font-size: 1.2rem; margin: 20px 0; color: white;">
                        ${message}
                    </p>
                    <button class="quiz-restart" onclick="restartQuiz()">
                        üîÑ Recommencer le quiz
                    </button>
                </div>
            `;
        }

        function restartQuiz() {
            showQuiz();
        }

        function showMemo() {
            // Mise √† jour du titre
            chaptersTitle.textContent = "üß† M√©mo 30 secondes - Testez votre m√©moire !";
            
            // Masquer les boutons de chapitres
            chaptersGrid.style.display = 'none';
            
            // Masquer l'histoire pr√©c√©dente
            storyDisplay.classList.remove('show');
            
            // Cr√©er l'interface de s√©lection
            createMemoSelection();
            
            // Afficher le conteneur avec animation
            setTimeout(() => {
                chaptersContainer.classList.add('show');
            }, 100);
        }

        function createMemoSelection() {
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <h2 style="color: #4a90e2; margin-bottom: 20px;">üß† M√©mo 30 secondes</h2>
                        <p style="font-size: 1.1rem; margin-bottom: 30px; color: white;">
                            Choisissez une cat√©gorie et un chapitre. Vous aurez le temps de lire l'histoire, 
                            puis 30 secondes pour r√©pondre √† une question de m√©moire !
                        </p>
                        
                        <div style="display: grid; gap: 15px; max-width: 400px; margin: 0 auto;">
                            <select id="memo-category" class="memo-input" style="cursor: pointer;">
                                <option value="">-- Choisissez une cat√©gorie --</option>
                                <option value="enfant">Histoire Enfant</option>
                                <option value="adulte">Histoire Adulte</option>
                                <option value="religion">Histoire Religion</option>
                            </select>
                            
                            <select id="memo-chapter" class="memo-input" style="cursor: pointer;" disabled>
                                <option value="">-- Choisissez un chapitre --</option>
                            </select>
                            
                            <button class="memo-submit" id="memo-start" onclick="startMemoGame()" disabled>
                                üöÄ Commencer le d√©fi m√©moire
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            chaptersGrid.style.display = 'block';
            
            // Ajouter les √©v√©nements
            document.getElementById('memo-category').addEventListener('change', function() {
                const chapterSelect = document.getElementById('memo-chapter');
                const startButton = document.getElementById('memo-start');
                
                if (this.value) {
                    chapterSelect.disabled = false;
                    chapterSelect.innerHTML = `
                        <option value="">-- Choisissez un chapitre --</option>
                        <option value="1">Chapitre 1</option>
                        <option value="2">Chapitre 2</option>
                        <option value="3">Chapitre 3</option>
                        <option value="4">Chapitre 4</option>
                        <option value="5">Chapitre 5</option>
                    `;
                } else {
                    chapterSelect.disabled = true;
                    chapterSelect.innerHTML = '<option value="">-- Choisissez un chapitre --</option>';
                    startButton.disabled = true;
                }
            });
            
            document.getElementById('memo-chapter').addEventListener('change', function() {
                const startButton = document.getElementById('memo-start');
                startButton.disabled = !this.value;
            });
        }

        function startMemoGame() {
            const category = document.getElementById('memo-category').value;
            const chapter = parseInt(document.getElementById('memo-chapter').value);
            
            currentMemo.category = category;
            currentMemo.chapter = chapter;
            currentMemo.question = memoQuestions[category][chapter - 1];
            currentMemo.phase = 'reading';
            
            showMemoReading();
        }

        function showMemoReading() {
            const story = stories[currentMemo.category].chapters[currentMemo.chapter];
            
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <h2 style="color: #4a90e2; margin-bottom: 20px;">üìñ Lisez attentivement</h2>
                        <p style="color: #ffc107; font-weight: 600; margin-bottom: 20px;">
                            Prenez le temps de bien lire cette histoire. Vous allez devoir r√©pondre √† une question apr√®s !
                        </p>
                        
                        <div class="memo-story">
                            <h3 style="color: #4a90e2; margin-bottom: 15px;">Chapitre ${currentMemo.chapter}</h3>
                            <p>${story}</p>
                        </div>
                        
                        <button class="memo-submit" onclick="startMemoTimer()">
                            ‚úÖ J'ai fini de lire, commencer le test !
                        </button>
                    </div>
                </div>
            `;
        }

        function startMemoTimer() {
            currentMemo.phase = 'questioning';
            currentMemo.timeLeft = 30;
            currentMemo.answered = false;
            
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <div class="memo-timer" id="memo-timer">‚è∞ ${currentMemo.timeLeft} secondes</div>
                        
                        <div class="memo-question">
                            <h3>üß† Question :</h3>
                            <p style="font-size: 1.1rem; color: white;">${currentMemo.question.question}</p>
                            <p style="color: #ffc107; margin-top: 10px;">‚û§ T'as 30 secondes pour t'en souvenir.</p>
                        </div>
                        
                        <div class="quiz-answers" id="memo-answers">
                            ${currentMemo.question.answers.map((answer, index) => 
                                `<button class="quiz-answer" onclick="selectMemoAnswer(${index})">${answer}</button>`
                            ).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // D√©marrer le timer
            startTimer();
        }

        function startTimer() {
            currentMemo.timer = setInterval(() => {
                currentMemo.timeLeft--;
                const timerElement = document.getElementById('memo-timer');
                
                if (timerElement) {
                    timerElement.textContent = `‚è∞ ${currentMemo.timeLeft} secondes`;
                    
                    // Changer les couleurs selon le temps restant
                    if (currentMemo.timeLeft <= 5) {
                        timerElement.className = 'memo-timer danger';
                    } else if (currentMemo.timeLeft <= 10) {
                        timerElement.className = 'memo-timer warning';
                    }
                }
                
                if (currentMemo.timeLeft <= 0) {
                    clearInterval(currentMemo.timer);
                    timeUp();
                }
            }, 1000);
        }

        function selectMemoAnswer(selectedIndex) {
            if (currentMemo.answered) return;
            
            currentMemo.answered = true;
            
            if (currentMemo.timer) {
                clearInterval(currentMemo.timer);
            }
            
            const correctIndex = currentMemo.question.correct;
            const answers = document.querySelectorAll('.quiz-answer');
            
            answers.forEach((answer, index) => {
                answer.classList.add('disabled');
                if (index === correctIndex) {
                    answer.classList.add('correct');
                } else if (index === selectedIndex) {
                    answer.classList.add('wrong');
                }
            });
            
            const isCorrect = selectedIndex === correctIndex;
            const selectedAnswer = currentMemo.question.answers[selectedIndex];
            
            // Attendre un peu pour laisser voir l'animation
            setTimeout(() => {
                showMemoResult(isCorrect, selectedAnswer, false);
            }, 1500);
        }

        function timeUp() {
            if (currentMemo.answered) return;
            
            currentMemo.answered = true;
            const answers = document.querySelectorAll('.quiz-answer');
            const correctIndex = currentMemo.question.correct;
            
            answers.forEach((answer, index) => {
                answer.classList.add('disabled');
                if (index === correctIndex) {
                    answer.classList.add('correct');
                }
            });
            
            setTimeout(() => {
                showMemoResult(false, '', true);
            }, 1500);
        }

        function showMemoResult(isCorrect, userAnswer = '', timeExpired = false) {
            currentMemo.phase = 'finished';
            
            let resultMessage, resultClass;
            
            if (timeExpired) {
                resultMessage = "‚è∞ Temps √©coul√© ! Vous n'avez pas r√©pondu √† temps.";
                resultClass = "failure";
            } else if (isCorrect) {
                resultMessage = "üéâ Bravo ! Excellente m√©moire !";
                resultClass = "success";
            } else {
                resultMessage = "‚ùå Pas tout √† fait... R√©essayez pour am√©liorer votre m√©moire !";
                resultClass = "failure";
            }
            
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <h2 style="color: #4a90e2; margin-bottom: 20px;">üìä R√©sultat</h2>
                        
                        <div class="memo-result ${resultClass}">
                            ${resultMessage}
                        </div>
                        
                        <div style="background: rgba(74, 144, 226, 0.1); padding: 20px; border-radius: 10px; margin: 20px 0;">
                            <p style="color: #4a90e2; font-weight: 600; margin-bottom: 10px;">Question :</p>
                            <p style="color: white; margin-bottom: 15px;">${currentMemo.question.question}</p>
                            
                            <p style="color: #4a90e2; font-weight: 600; margin-bottom: 10px;">Bonne r√©ponse :</p>
                            <p style="color: #28a745; font-weight: 600; margin-bottom: 15px;">${currentMemo.question.answers[currentMemo.question.correct]}</p>
                            
                            ${userAnswer && !timeExpired ? `
                                <p style="color: #4a90e2; font-weight: 600; margin-bottom: 10px;">Votre r√©ponse :</p>
                                <p style="color: ${isCorrect ? '#28a745' : '#dc3545'}; font-weight: 600;">${userAnswer}</p>
                            ` : ''}
                            
                            <div style="margin-top: 15px; padding: 10px; background: rgba(255, 196, 57, 0.1); border-radius: 5px; border-left: 3px solid #ffc439;">
                                <p style="color: #ffc439; font-weight: 600; margin-bottom: 5px;">üí° Explication :</p>
                                <p style="color: white; font-size: 0.95rem;">${currentMemo.question.explanation}</p>
                            </div>
                        </div>
                        
                        <button class="memo-restart" onclick="showMemo()">
                            üîÑ Nouveau d√©fi m√©moire
                        </button>
                    </div>
                </div>
            `;
        }

        function showEnigme() {
            // Initialiser l'√©nigme 30 secondes
            currentEnigme = {
                currentEnigme: Math.floor(Math.random() * enigmeData.enigmes.length),
                currentQuestion: 0,
                answers: [null, null, null],
                timer: null,
                timeLeft: 30,
                phase: 'viewing',
                finished: false
            };
            
            // Mise √† jour du titre
            chaptersTitle.textContent = "üñºÔ∏è √ânigme 30 secondes - Observez bien !";
            
            // Masquer les boutons de chapitres
            chaptersGrid.style.display = 'none';
            
            // Masquer l'histoire pr√©c√©dente
            storyDisplay.classList.remove('show');
            
            // Cr√©er l'interface d'√©nigmes avec image
            createEnigmeImageInterface();
            
            // Afficher le conteneur avec animation
            setTimeout(() => {
                chaptersContainer.classList.add('show');
            }, 100);
        }

        function createEnigmeImageInterface() {
            const currentEnigmeData = enigmeData.enigmes[currentEnigme.currentEnigme];
            
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <h2 style="color: #4a90e2; margin-bottom: 20px;">üñºÔ∏è Observez bien cette image</h2>
                        <p style="color: #ffc107; font-weight: 600; margin-bottom: 20px;">
                            Regardez attentivement l'image, puis r√©pondez aux 3 questions en 30 secondes !
                        </p>
                        
                        <div style="text-align: center; margin: 20px 0;">
                            <div class="image-loader" style="min-height: 300px; display: flex; align-items: center; justify-content: center; background: rgba(74, 144, 226, 0.1); border-radius: 10px; border: 2px solid #4a90e2;">
                                <div style="color: #4a90e2; font-size: 1.2rem;">üñºÔ∏è Chargement de l'image...</div>
                            </div>
                            <p style="color: #4a90e2; margin-top: 10px; font-weight: 600;">${currentEnigmeData.title}</p>
                        </div>
                        
                        <button class="memo-submit" id="start-enigme-btn" onclick="startEnigmeTimer()" disabled style="opacity: 0.5;">
                            üöÄ Chargement en cours...
                        </button>
                    </div>
                </div>
            `;
            
            // Lazy load de l'image avec optimisations
            lazyLoadImage(currentEnigmeData.image, currentEnigmeData.title, 'start-enigme-btn');
            chaptersGrid.style.display = 'block';
        }

        // Fonction optimis√©e de lazy loading
        function lazyLoadImage(src, alt, buttonId) {
            const img = new Image();
            const startTime = performance.now();
            
            img.onload = function() {
                const loadTime = performance.now() - startTime;
                console.log(`üöÄ Image charg√©e en ${Math.round(loadTime)}ms`);
                
                // Remplacer le loader par l'image avec transition fluide
                const loader = document.querySelector('.image-loader');
                if (loader) {
                    loader.style.transition = 'opacity 0.3s ease';
                    loader.style.opacity = '0';
                    
                    setTimeout(() => {
                        loader.outerHTML = `
                            <img src="${src}" 
                                 alt="${alt}" 
                                 style="max-width: 100%; max-height: 400px; border-radius: 10px; border: 2px solid #4a90e2; box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3); opacity: 0; transition: opacity 0.3s ease;"
                                 onload="this.style.opacity='1'">
                        `;
                        
                        // Activer le bouton
                        const button = document.getElementById(buttonId);
                        if (button) {
                            button.disabled = false;
                            button.style.opacity = '1';
                            button.textContent = 'üöÄ J\'ai bien observ√©, commencer le d√©fi !';
                        }
                    }, 300);
                }
            };
            
            img.onerror = function() {
                console.error('‚ùå Erreur de chargement de l\'image');
                const loader = document.querySelector('.image-loader');
                if (loader) {
                    loader.innerHTML = '<div style="color: #dc3545;">‚ùå Erreur de chargement</div>';
                }
            };
            
            // Optimisation : ajouter des param√®tres de compression
            img.src = src + (src.includes('?') ? '&' : '?') + 'auto=compress&cs=tinysrgb&dpr=2&h=600&w=800';
        }

        function startEnigmeTimer() {
            const currentEnigmeData = enigmeData.enigmes[currentEnigme.currentEnigme];
            currentEnigme.phase = 'questioning';
            currentEnigme.timeLeft = 30;
            currentEnigme.currentQuestion = 0;
            
            showEnigmeQuestion();
            
            // D√©marrer le timer
            currentEnigme.timer = setInterval(() => {
                currentEnigme.timeLeft--;
                const timerElement = document.getElementById('enigme-timer');
                
                if (timerElement) {
                    timerElement.textContent = `‚è∞ ${currentEnigme.timeLeft} secondes`;
                    
                    // Changer les couleurs selon le temps restant
                    if (currentEnigme.timeLeft <= 5) {
                        timerElement.className = 'memo-timer danger';
                    } else if (currentEnigme.timeLeft <= 10) {
                        timerElement.className = 'memo-timer warning';
                    }
                }
                
                if (currentEnigme.timeLeft <= 0) {
                    clearInterval(currentEnigme.timer);
                    enigmeTimeUp();
                }
            }, 1000);
        }

        function showEnigmeQuestion() {
            const currentEnigmeData = enigmeData.enigmes[currentEnigme.currentEnigme];
            const currentQuestion = currentEnigmeData.questions[currentEnigme.currentQuestion];
            
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <div class="memo-timer" id="enigme-timer">‚è∞ ${currentEnigme.timeLeft} secondes</div>
                        
                        <div style="text-align: center; margin: 15px 0;">
                            <div style="background: linear-gradient(135deg, #4a90e2, #357abd); color: white; padding: 8px 16px; border-radius: 15px; display: inline-block; margin-bottom: 15px;">
                                Question ${currentEnigme.currentQuestion + 1} / 3
                            </div>
                        </div>
                        
                        <div class="memo-question">
                            <h3>${currentQuestion.question}</h3>
                            <div class="quiz-answers" id="enigme-answers">
                                ${currentQuestion.answers.map((answer, index) => 
                                    `<button class="quiz-answer" onclick="selectEnigmeImageAnswer(${index})">${answer}</button>`
                                ).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function selectEnigmeImageAnswer(selectedIndex) {
            const currentEnigmeData = enigmeData.enigmes[currentEnigme.currentEnigme];
            const currentQuestion = currentEnigmeData.questions[currentEnigme.currentQuestion];
            
            // Stocker la r√©ponse
            currentEnigme.answers[currentEnigme.currentQuestion] = selectedIndex;
            
            // Passer √† la question suivante
            currentEnigme.currentQuestion++;
            
            if (currentEnigme.currentQuestion < 3) {
                // Question suivante
                showEnigmeQuestion();
            } else {
                // Toutes les questions r√©pondues
                clearInterval(currentEnigme.timer);
                showEnigmeImageResults();
            }
        }

        function enigmeTimeUp() {
            if (currentEnigme.finished) return;
            
            currentEnigme.finished = true;
            showEnigmeImageResults();
        }

        function showEnigmeImageResults() {
            const currentEnigmeData = enigmeData.enigmes[currentEnigme.currentEnigme];
            let correctAnswers = 0;
            
            // Compter les bonnes r√©ponses
            for (let i = 0; i < 3; i++) {
                if (currentEnigme.answers[i] !== null && 
                    currentEnigme.answers[i] === currentEnigmeData.questions[i].correct) {
                    correctAnswers++;
                }
            }
            
            const allCorrect = correctAnswers === 3;
            let resultMessage, resultClass;
            
            if (allCorrect) {
                resultMessage = "üéâ PARFAIT ! Vous avez tout juste ! Excellente observation !";
                resultClass = "success";
            } else {
                resultMessage = `‚ùå ${correctAnswers}/3 bonnes r√©ponses. Il fallait TOUTES les bonnes r√©ponses pour r√©ussir !`;
                resultClass = "failure";
            }
            
            chaptersGrid.innerHTML = `
                <div class="memo-container">
                    <div class="memo-phase">
                        <h2 style="color: #4a90e2; margin-bottom: 20px;">üìä R√©sultat de l'√©nigme</h2>
                        
                        <div class="memo-result ${resultClass}">
                            ${resultMessage}
                        </div>
                        
                        <div style="background: rgba(74, 144, 226, 0.1); padding: 20px; border-radius: 10px; margin: 20px 0;">
                            <h3 style="color: #4a90e2; margin-bottom: 15px;">üìã D√©tail des r√©ponses :</h3>
                            
                            ${currentEnigmeData.questions.map((question, index) => `
                                <div style="margin-bottom: 15px; padding: 10px; border-radius: 5px; border-left: 3px solid ${
                                    currentEnigme.answers[index] === question.correct ? '#28a745' : '#dc3545'
                                };">
                                    <p style="color: #4a90e2; font-weight: 600; margin-bottom: 5px;">
                                        ${index + 1}. ${question.question}
                                    </p>
                                    <p style="color: #28a745; margin-bottom: 3px;">
                                        ‚úÖ Bonne r√©ponse : ${question.answers[question.correct]}
                                    </p>
                                    ${currentEnigme.answers[index] !== null ? `
                                        <p style="color: ${currentEnigme.answers[index] === question.correct ? '#28a745' : '#dc3545'};">
                                            ${currentEnigme.answers[index] === question.correct ? '‚úÖ' : '‚ùå'} Votre r√©ponse : ${question.answers[currentEnigme.answers[index]]}
                                        </p>
                                    ` : `
                                        <p style="color: #ffc107;">‚è∞ Pas de r√©ponse (temps √©coul√©)</p>
                                    `}
                                </div>
                            `).join('')}
                        </div>
                        
                        <button class="memo-restart" onclick="showEnigme()">
                            üîÑ Nouvelle √©nigme image
                        </button>
                    </div>
                </div>
            `;
        }



        // Syst√®me de vid√©os quotidiennes
        const dailyVideos = [
            {
                url: 'https://www.w3schools.com/html/mov_bbb.mp4',
                title: 'Big Buck Bunny - Lundi',
                description: 'Animation 3D par Blender Foundation'
            },
            {
                url: 'https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4',
                title: 'Nature - Mardi', 
                description: 'Vid√©o de d√©monstration nature'
            },
            {
                url: 'https://www.w3schools.com/html/movie.mp4',
                title: 'D√©monstration - Mercredi',
                description: 'Vid√©o de test W3Schools'
            },
            {
                url: 'https://www.w3schools.com/html/mov_bbb.mp4',
                title: 'Big Buck Bunny - Jeudi',
                description: 'Retour du classique d\'animation'
            },
            {
                url: 'https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_2mb.mp4',
                title: 'Oc√©an - Vendredi',
                description: 'Vid√©o relaxante pour finir la semaine'
            },
            {
                url: 'https://www.w3schools.com/html/mov_bbb.mp4',
                title: 'Weekend Bunny - Samedi',
                description: 'Animation sp√©ciale weekend'
            },
            {
                url: 'https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4',
                title: 'Dimanche Zen - Dimanche',
                description: 'Vid√©o apaisante pour le dimanche'
            }
        ];

        function setDailyVideo() {
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0 = Dimanche, 1 = Lundi, etc.
            
            // Utiliser l'index bas√© sur le jour de la semaine
            const videoIndex = dayOfWeek;
            const todayVideo = dailyVideos[videoIndex];
            
            const videoElement = document.getElementById('daily-video');
            const videoInfo = document.getElementById('video-info');
            
            // Changer la source de la vid√©o
            videoElement.src = todayVideo.url;
            
            // Mettre √† jour les informations
            videoInfo.innerHTML = `
                üé¨ ${todayVideo.title}<br>
                <small style="opacity: 0.8;">${todayVideo.description}</small>
            `;
            
            // Relancer la vid√©o
            videoElement.load();
            
            console.log(`Vid√©o du jour charg√©e: ${todayVideo.title}`);
        }

        // Fonction pour v√©rifier et changer la vid√©o √† minuit
        function checkForNewDay() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            
            // Si c'est minuit (00:00), changer la vid√©o
            if (hours === 0 && minutes === 0) {
                setDailyVideo();
                console.log('Nouvelle vid√©o charg√©e pour le nouveau jour !');
            }
        }

        // Performance Monitoring
        const performanceMonitor = {
            startTime: performance.now(),
            
            logMetric: function(label, value) {
                console.log(`üöÄ ${label}: ${Math.round(value)}ms`);
            },
            
            measureFunction: function(fn, label) {
                const start = performance.now();
                const result = fn();
                this.logMetric(label, performance.now() - start);
                return result;
            }
        };

        // Optimisation : Debouncing pour les √©v√©nements fr√©quents
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Optimisation : RequestAnimationFrame pour les animations
        function optimizedAnimation(callback) {
            if (window.requestAnimationFrame) {
                return window.requestAnimationFrame(callback);
            } else {
                return setTimeout(callback, 16); // Fallback ~60fps
            }
        }

        // Optimisation : Intersection Observer pour lazy loading
        const imageObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    if (img.dataset.src) {
                        img.src = img.dataset.src;
                        img.removeAttribute('data-src');
                        imageObserver.unobserve(img);
                    }
                }
            });
        }, {
            rootMargin: '50px 0px',
            threshold: 0.1
        });

        // Optimisation : Cache des donn√©es pour √©viter les recalculs
        const dataCache = new Map();

        function getCachedData(key, generator) {
            if (dataCache.has(key)) {
                return dataCache.get(key);
            }
            const data = generator();
            dataCache.set(key, data);
            return data;
        }

        // Optimisation : Pr√©chargement des ressources critiques
        function preloadCriticalResources() {
            const criticalImages = [
                'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=300&fit=crop',
                'https://images.unsplash.com/photo-1518837695005-2083093ee35b?w=400&h=300&fit=crop'
            ];

            criticalImages.forEach(url => {
                const link = document.createElement('link');
                link.rel = 'prefetch';
                link.href = url;
                document.head.appendChild(link);
            });
        }

        // Optimisation : R√©duction de la fr√©quence des √©v√©nements
        const optimizedEventHandlers = {
            scroll: debounce(() => {
                // Logique de scroll optimis√©e
            }, 100),
            
            resize: debounce(() => {
                // Logique de resize optimis√©e
                performanceMonitor.logMetric('Resize handled', 0);
            }, 250)
        };

        // D√©tection des capacit√©s du navigateur
        const browserCapabilities = {
            supportsWebP: () => {
                const canvas = document.createElement('canvas');
                return canvas.toDataURL('image/webp').indexOf('data:image/webp') === 0;
            },
            
            supportsIntersectionObserver: () => {
                return 'IntersectionObserver' in window;
            },
            
            supportsRequestIdleCallback: () => {
                return 'requestIdleCallback' in window;
            }
        };

        // Fonction d'optimisation du chargement des images
        function optimizedImageLoading(src, alt, callback) {
            const startTime = performance.now();
            const img = new Image();
            
            // Optimiser le format selon le support du navigateur
            let optimizedSrc = src;
            if (browserCapabilities.supportsWebP()) {
                optimizedSrc = src.replace(/\.(jpg|jpeg|png)/, '.webp');
            }
            
            img.onload = function() {
                const loadTime = performance.now() - startTime;
                performanceMonitor.logMetric(`Image ${alt} charg√©e`, loadTime);
                if (callback) callback(img, loadTime);
            };
            
            img.onerror = function() {
                console.warn(`‚ùå √âchec de chargement: ${alt}`);
                // Fallback vers l'image originale si WebP √©choue
                if (optimizedSrc !== src) {
                    img.src = src;
                }
            };
            
            img.src = optimizedSrc;
            return img;
        }

        // Animation au chargement optimis√©e
        window.addEventListener('load', function() {
            const loadStartTime = performanceMonitor.startTime;
            
            performanceMonitor.measureFunction(() => {
                document.body.style.opacity = '0';
                document.body.style.transition = 'opacity 0.5s ease';
                
                // Pr√©charger les ressources critiques
                preloadCriticalResources();
                
                // Charger la vid√©o du jour
                setDailyVideo();
                
                // Optimiser l'apparition de la page
                optimizedAnimation(() => {
                    document.body.style.opacity = '1';
                });
                
            }, 'Page initialization');
            
            // Mesurer le temps de chargement total
            performanceMonitor.logMetric('Total load time', performance.now() - loadStartTime);
            
            // V√©rifier toutes les minutes si on doit changer de vid√©o
            setInterval(checkForNewDay, 60000);
            
            // Ajouter les event listeners optimis√©s
            window.addEventListener('scroll', optimizedEventHandlers.scroll, { passive: true });
            window.addEventListener('resize', optimizedEventHandlers.resize, { passive: true });
        });

        // Performance Observer pour surveiller les m√©triques
        if ('PerformanceObserver' in window) {
            const observer = new PerformanceObserver((list) => {
                for (const entry of list.getEntries()) {
                    if (entry.entryType === 'navigation') {
                        performanceMonitor.logMetric('DOM Content Loaded', entry.domContentLoadedEventEnd - entry.domContentLoadedEventStart);
                        performanceMonitor.logMetric('Load Complete', entry.loadEventEnd - entry.loadEventStart);
                    }
                }
            });
            
            observer.observe({ entryTypes: ['navigation'] });
        }
    </script>
</body>
</html>
